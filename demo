stages:
  - read_file

read_file_job:
  stage: read_file
  image: python:3.10  # or any image with Ansible or install it manually
  before_script:
    - apt update && apt install -y ansible
  script:
    - echo "Running Ansible playbook with path: $FILE_PATH"
    - ansible-playbook read_file_playbook.yml --extra-vars "file_path=$FILE_PATH"



---
- name: Read file from path
  hosts: localhost
  gather_facts: no
  tasks:
    - name: Check if the file exists
      stat:
        path: "{{ file_path }}"
      register: file_status

    - name: Print file content
      when: file_status.stat.exists
      shell: cat "{{ file_path }}"
      register: file_content
      changed_when: false

    - name: Display file content
      when: file_status.stat.exists
      debug:
        msg: "{{ file_content.stdout }}"

    - name: Fail if file does not exist
      when: not file_status.stat.exists
      fail:
        msg: "File not found at {{ file_path }}"
